webpackJsonp([3],{"9zKl":function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=i("//Fk"),o=i.n(r),a=i("znnA"),n=i("L6bb"),s=i.n(n),l=i("Ea+1"),d={data:function(){return{dialogTitle:"新增用户",dialogFormVisible:!1,userList:[],roleList:[],form:{}}},computed:{disableAddBtn:function(){var e=this.form,t=e.userName,i=e.password,r=e.roleId;return!t||!i||!r}},created:function(){this.getUserList(),this.initForm()},methods:{initForm:function(){this.form={id:"",userName:"",password:"",roleId:"",roleName:"",expirationTime:""}},getUserList:function(){var e=this;l.a.config.getUsers().then(function(t){var i=t.data;e.userList=i&&i.data||[]}).catch(function(){return a.a.error("获取用户列表,请刷新重试~")})},handleAddUser:function(){var e=this;this.dialogFormVisible=!0,this.dialogTitle="新增用户",l.a.config.getRoles().then(function(t){var i=t.data.data||[];e.setRoleList(i)})},handleEdit:function(e,t){var i=this;this.dialogTitle="编辑用户",this.dialogFormVisible=!0,l.a.config.getRoles().then(function(e){var r=e.data.data||[];i.setRoleList(r);var o=t.id,a=t.userName,n=t.roleId;i.form.id=o,i.form.userName=a,i.form.roleId=n})},setRoleList:function(e){e.forEach(function(e){e.roleId=e.id}),this.roleList=e},handleDelete:function(e,t){var i=this;this.$alert("","确认删除该用户?",{confirmButtonText:"确定",callback:function(e){l.a.config.delUser(t.id).then(function(e){if(!e.data.success)return o.a.reject();i.$message({type:"info",message:"删除用户"+t.userName+"成功"}),i.getUserList()}).catch(function(){return a.a.error("删除用户失败,请重新尝试~")})}})},handleSubmitUser:function(){var e=this,t=this.form,i=t.id,r=t.password,n=t.userName,d=t.expirationTime,c=t.roleId;l.a.config.addUser({id:i,roleId:c,userName:n,password:s()(r),expirationTime:d,enable:!0}).then(function(t){if(!t.data.success)return o.a.reject();e.getUserList(),e.dialogFormVisible=!1,e.initForm()}).catch(function(){a.a.error("新增用户失败,请重新尝试~"),e.dialogFormVisible=!1,e.initForm()})}}},c={render:function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticClass:"user-wrap"},[i("el-table",{attrs:{data:e.userList,align:"center","header-cell-class-name":"background-f5"}},[i("el-table-column",{attrs:{label:"用户名"},scopedSlots:e._u([{key:"default",fn:function(t){return[i("span",[e._v(e._s(t.row.userName))])]}}])}),i("el-table-column",{attrs:{label:"用户角色"},scopedSlots:e._u([{key:"default",fn:function(t){return[i("span",[e._v(e._s(t.row.roleName))])]}}])}),i("el-table-column",{attrs:{label:"创建时间"},scopedSlots:e._u([{key:"default",fn:function(t){return[i("span",[e._v(e._s(t.row.createTime))])]}}])}),i("el-table-column",{attrs:{label:"操作"},scopedSlots:e._u([{key:"default",fn:function(t){return[i("el-button",{attrs:{size:"mini"},on:{click:function(i){e.handleEdit(t.$index,t.row)}}},[e._v("编辑")]),i("el-button",{attrs:{size:"mini",type:"danger"},on:{click:function(i){e.handleDelete(t.$index,t.row)}}},[e._v("删除")])]}}])})],1),i("div",{staticClass:"add-user"},[i("el-button",{attrs:{size:"medium",type:"primary"},on:{click:function(t){e.handleAddUser()}}},[e._v("新增")])],1),i("el-dialog",{attrs:{title:e.dialogTitle,visible:e.dialogFormVisible},on:{"update:visible":function(t){e.dialogFormVisible=t},close:function(t){e.initForm()}}},[i("el-form",{attrs:{model:e.form,"label-width":"60px"}},[i("el-form-item",{attrs:{label:"用户名"}},[i("el-input",{model:{value:e.form.userName,callback:function(t){e.$set(e.form,"userName",t)},expression:"form.userName"}})],1),i("el-form-item",{attrs:{label:"密码"}},[i("el-input",{model:{value:e.form.password,callback:function(t){e.$set(e.form,"password",t)},expression:"form.password"}})],1),i("el-form-item",{attrs:{label:"角色"}},[i("el-select",{attrs:{placeholder:"请选择"},model:{value:e.form.roleId,callback:function(t){e.$set(e.form,"roleId",t)},expression:"form.roleId"}},e._l(e.roleList,function(e){return i("el-option",{key:e.roleId,attrs:{label:e.roleName,value:e.roleId}})}))],1)],1),i("div",{staticClass:"dialog-footer"},[i("el-button",{on:{click:function(t){e.dialogFormVisible=!1}}},[e._v("取消")]),i("el-button",{attrs:{disabled:e.disableAddBtn,type:"primary"},on:{click:function(t){e.handleSubmitUser()}}},[e._v("确定")])],1)],1)],1)},staticRenderFns:[]};var u=i("VU/8")(d,c,!1,function(e){i("KgMX")},"data-v-718c527e",null);t.default=u.exports},KgMX:function(e,t){}});
//# sourceMappingURL=3.7eae1a5433f796472feb.js.map